{% extends 'crmusernav.html' %}
{% block content %}
{% load static %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<style>
body{
    background-color: #DFF5FF;
}
.content{

    height: 40vh;
  
}

.content h1{
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 4em;
}

.content h1:nth-child(1){
    color:transparent;
    -webkit-text-stroke: 1px #080808;
}

.content h1:nth-child(2){
    color: #0c0c0c;
    animation: animate 4s ease-in-out infinite;
}

@keyframes animate
{
    0%, 100%{
        clip-path: polygon(0% 45%, 15% 44%, 32% 50%, 54% 60%, 70% 61%, 84% 59%, 100% 52%, 100% 100%, 0% 100%);
    }
    50%{
        clip-path: polygon(0% 60%, 16% 65%, 34% 66%, 51% 62%, 67% 50%, 84% 45%, 100% 46%, 100% 100%, 0% 100%);
    }
}
.delete-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1; /* Ensure it's above the card content */
}

/* Define styles for card */
.card1 {
    position: relative;
    padding-top: 80px;
    /* Add other styles as needed */
}

/* Define animation for delete icon */
.delete-icon.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

</style>
<main>
   
    <div class="content">
        <h1>ITEM</h1>
        <h1>ITEM</h1>
        
    </div>
<div class="row " id="card-container" style="border-radius: 20px;padding-left: 2%;" >
    {% for app in product1 %}
    {% if app.id not in archived_app_ids %}
    <div class="col-sm-2 mb-3">
        <div class="card"  draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" data-app-id="{{ app.id }}" style="border-radius:15px 50px 30px;border-color: black; background-color: rgb(137, 15, 15);">
            <div class="card1" >
                
               
                <div class="delete-icon" style="display: none;">
                
                    <a href="{% url 'archive_app' app.id  %}" class="delete-link" data-app-id="{{ app.id }}"><img src="{% static 'images/crmdelete.jpg' %}" class="img-fluid" width="56" ></a>
                </div>
              </div>
            <div class="card-body" >
             
                <h1 class="card-title text-warning" style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">{{ app.name }}</h1>
                <hr style="border-color: rgb(167, 127, 7); ">
                <p class="card-text text-danger"><b style="font-size: 2rem;" class="text-warning">{{ app.price }}</b></p>
            </div>
        </div>
    </div>
   
   
    {% endif %}
    {% endfor %}
    {% for app in product %}
    {% if app.id not in archived_app_ids %}
    <div class="col-sm-2 mb-3">
        <div class="card"  draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" data-app-id="{{ app.id }}" style="border-radius:15px 50px 30px;border-color: black;background-color: rgb(137, 15, 15);">
            <div class="card1" >
                
                <div class="delete-icon" style="display: none; ">
                 
                    <a href="{% url 'archive_app' app.id  %}" class="delete-link" data-app-id="{{ app.id }}"><img src="{% static 'images/crmdelete.jpg' %}" class="img-fluid" width="56" ></a>
                </div>
              </div>
            <div class="card-body" >
             
                <h1 class="card-title text-warning" style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">{{ app.name }}</h1>
                <hr style="border-color: rgb(167, 127, 7); ">
                <p class="card-text text-danger"><b style="font-size: 2rem;" class="text-warning">{{ app.price }}</b></p>
            </div>
        </div>
    </div>
   
    {% endif %}
    {% endfor %}
    
</div>



    
   
</main>


<script>
    function drag(event) {
        event.dataTransfer.setData("text", event.target.dataset.appId);
        // Show delete icon when dragging starts
        event.target.querySelector('.delete-icon').style.display = 'block';
    }

    function dragEnd(event) {
        // Hide delete icon when dragging ends
        event.target.querySelector('.delete-icon').style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', function () {
        const deleteLinks = document.querySelectorAll('.delete-link');

        deleteLinks.forEach(link => {
            link.addEventListener('dragover', function (event) {
                event.preventDefault();
            });

            link.addEventListener('drop', function (event) {
                event.preventDefault();
                const appId = event.dataTransfer.getData("text");
                const url = this.getAttribute('href').replace('app_id', appId);
                // Navigate to the URL
                window.location.href = url;
            });
        });
    });
    $(document).ready(function() {
    $('.card').hover(
        function() {
            $(this).find('.delete-icon').addClass('active');
        },
        function() {
            $(this).find('.delete-icon').removeClass('active');
        }
    );
});
</script>
{% endblock %}
