{% extends 'crmusernav.html' %}
{% block content %}
{% load static %}
<style>
body{
    background-color: #71dae6;
}

</style>
<main>
    
   
   
  <br>
     
<div class="row mt-3" id="card-container" style="border-radius: 20px;">
    {% for app in product1 %}
    {% if app.id not in archived_app_ids %}
    <div class="col-sm-4 mb-3"  style="border-radius: 20px;">
        <div class="card"  draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" data-app-id="{{ app.id }}">
            <div class="card-body" >
                <h1 class="card-title text-warning">{{ app.name }}</h1>
                <hr style="border-color: rgb(167, 127, 7); margin: 0 auto 0 0;">
                <p class="card-text text-danger"><b style="font-size: 2rem;" class="text-warning">{{ app.price }}</b></p>
               
                <div class="delete-icon" style="display: none;">
                    <a href="{% url 'archive_app' app.id  %}" class="delete-link" data-app-id="{{ app.id }}"><i class="fa-solid fa-box-archive" style="color: #000000;font-size: 5rem;"></i></a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    {% endfor %}
    {% for app in product %}
    {% if app.id not in archived_app_ids %}
    <div class="col-sm-4 mb-3">
        <div class="card"  draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" data-app-id="{{ app.id }}">
            <div class="card-body" >
                <h1 class="card-title text-warning">{{ app.name }}</h1>
                <hr style="border-color: rgb(167, 127, 7); margin: 0 auto 0 0;">
                <p class="card-text text-danger"><b style="font-size: 2rem;" class="text-warning">{{ app.price }}</b></p>
                <div class="delete-icon" style="display: none;">
                    <a href="{% url 'archive_app' app.id  %}" class="delete-link" data-app-id="{{ app.id }}"><i class="fa-solid fa-box-archive" style="color: #000000;font-size: 5rem;"></i></a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    {% endfor %}

</div>



    
   
</main>


<script>
    function drag(event) {
        event.dataTransfer.setData("text", event.target.dataset.appId);
        // Show delete icon when dragging starts
        event.target.querySelector('.delete-icon').style.display = 'block';
    }

    function dragEnd(event) {
        // Hide delete icon when dragging ends
        event.target.querySelector('.delete-icon').style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', function () {
        const deleteLinks = document.querySelectorAll('.delete-link');

        deleteLinks.forEach(link => {
            link.addEventListener('dragover', function (event) {
                event.preventDefault();
            });

            link.addEventListener('drop', function (event) {
                event.preventDefault();
                const appId = event.dataTransfer.getData("text");
                const url = this.getAttribute('href').replace('app_id', appId);
                // Navigate to the URL
                window.location.href = url;
            });
        });
    });
</script>
{% endblock %}
